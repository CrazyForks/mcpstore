# ç¼“å­˜æ¶æ„ï¼ˆRegistry ä¸ºå”¯ä¸€æƒå¨ï¼‰

æœ¬é¡µæè¿°æœ€æ–°ç¼“å­˜æœºåˆ¶ï¼šæ‰€æœ‰æŸ¥è¯¢å‡æ¥æºäºå†…å­˜â€œæ³¨å†Œè¡¨ç¼“å­˜â€ï¼ˆServiceRegistryï¼‰ï¼Œä¸å†å›é€€åˆ†ç‰‡æ–‡ä»¶ã€‚

## ğŸ§± ç¼“å­˜å±‚æ¬¡
- Registry ç¼“å­˜ï¼ˆæƒå¨ï¼‰ï¼š
  - æœåŠ¡å…ƒæ•°æ®ï¼ˆçŠ¶æ€ã€ç«¯ç‚¹ã€åç§°æ˜ å°„ï¼‰
  - å·¥å…·å®šä¹‰ï¼ˆå·¥å…·åˆ—è¡¨ä¸å…ƒä¿¡æ¯ï¼‰
  - Agent æ˜ å°„ï¼ˆä»…å†…å­˜ï¼Œä¸å†æŒä¹…åŒ–åˆ†ç‰‡ï¼‰
- è¿è¡ŒæœŸç»Ÿè®¡ï¼š
  - è°ƒç”¨æ¬¡æ•°ã€æˆåŠŸç‡ã€æ—¶å»¶åˆ†å¸ƒ
  - å¤±è´¥è®¡æ•°ã€è¿ç»­å¤±è´¥æ¬¡æ•°ï¼ˆä¾›ç”Ÿå‘½å‘¨æœŸä½¿ç”¨ï¼‰

```mermaid
graph TD
    A[mcp.json] -->|å¯åŠ¨åŠ è½½| B[ServiceOperations]
    B -->|æ³¨å†ŒæœåŠ¡| C[Orchestrator]
    C -->|è¿æ¥/æšä¸¾| D[FastMCP]
    D -->|tools/meta| E[ServiceRegistry]
    E --> F[List APIs]
    F -->|list_services/list_tools| User[ç”¨æˆ·]
```

## ğŸ” ç¼“å­˜æ›´æ–°è§¦å‘
- æ³¨å†Œ/é‡è¿ï¼šè¿æ¥æˆåŠŸåç”± Orchestrator._update_service_cache() å…¨é‡å†™å…¥å·¥å…·å®šä¹‰ä¸æ˜ å°„
- å·¥å…·å˜åŒ–ï¼ˆè¿è¡ŒæœŸï¼‰ï¼šToolsUpdateMonitor æ£€æµ‹åˆ°å·®å¼‚ â†’ è§¦å‘ ServiceContentManager.force_update_service_content() â†’ å…¨é‡åˆ·æ–° tool_cache
- add_service/update/deleteï¼šæ›´æ–° mcp.json åç”± UnifiedMCPSyncManager åŒæ­¥å¹¶é©±åŠ¨æ³¨å†Œ/é‡è¿ï¼Œåˆ·æ–°ç¼“å­˜
- å·¥å…·è°ƒç”¨ï¼šè®°å½•ç»Ÿè®¡æ•°æ®ä½†ä¸æ”¹å˜å®šä¹‰ç¼“å­˜

## ğŸš« ä¸å†å­˜åœ¨
- agent_clients.json / client_services.json åˆ†ç‰‡æ–‡ä»¶
- ä»åˆ†ç‰‡æ–‡ä»¶å›é€€è¯»å–çš„é€»è¾‘

## ğŸ§ª ä¸€è‡´æ€§ç­–ç•¥
- å•æº mcp.json + è¿è¡ŒæœŸå†…å­˜ç¼“å­˜
- å¯åŠ¨é¡ºåºï¼šmcp.json â†’ æ³¨å†Œ â†’ FastMCP è¿æ¥ â†’ Registry ç¼“å­˜
- è‹¥ç¼“å­˜ç¼ºå¤±ï¼šå±äºæœªåˆå§‹åŒ–/å¤±è´¥çŠ¶æ€ï¼Œé€šè¿‡ç”Ÿå‘½å‘¨æœŸæœºåˆ¶å¤„ç†ï¼ˆä¸å›é€€ç£ç›˜åˆ†ç‰‡ï¼‰

## ğŸ§­ æŸ¥è¯¢è·¯å¾„
- list_services(): Registry.services
- list_tools(): Registry.tools
- get_service_info(): Registry.services[name]

æ›´æ–°æ—¶é—´ï¼š2025-08-18

